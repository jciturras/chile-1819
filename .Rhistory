setwd("C:/Users/Usuario/Dropbox/fondecyt regular 2015/Papers Proyecto/Infografía1019/chile-1819")
library(dplyr)
library(ggplot2)
library(sjPlot)
library(scales)
library(ggthemes)
library(Cairo)
library(grid)
library(gridExtra)
library(sjlabelled)
library(questionr)
rm(list=ls())
options(OutDec = ",")
anio <- c(2009,2011,2013,2017)
gini <- c(48.0,47.1,46.5,46.0)
data <- data.frame(anio,gini)
g1=ggplot(data) +
geom_line(aes(x=anio, y=gini, color = "red")) +
geom_point(aes(x=anio, y=gini),size=3.0) +
scale_y_continuous(limits=c(0,100),breaks = seq(0,100,by=10)) +
scale_x_continuous(breaks = seq(2009,2017,by=2.0))+
xlab("Año")+
ylab("Percentaje") +
theme_bw()+
theme(legend.position="none") +
ggtitle("Coeficiente de Gini") + theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.position = "bottom",
axis.text=element_text(size=12),
axis.title.y = element_text(size=14, face="bold"),
plot.title=element_text(hjust=0.5,size = 10,face = "bold"))+
guides(colour=FALSE)
g1
install.packages("Cairo")
g2=ggplot(oecd) +
geom_line(aes(x=anio, y=gasto, color = "red")) +
geom_point(aes(x=anio, y=gasto),size=3.0) +
scale_y_continuous(limits=c(0,100),breaks = seq(0,100,by=10)) +
scale_x_continuous(breaks = seq(2009,2017,by=2.0))+
xlab("Año")+
ylab("Porcentaje") +
theme_bw()+
theme(legend.position="none") +
ggtitle("Gasto social") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.position = "bottom",
axis.text=element_text(size=12),
axis.title.y = element_text(size=14, face="bold"),
plot.title=element_text(hjust=0.5,size = 10,face = "bold"))+
guides(colour=FALSE)
g2
gasto <- c(10.4,10.8,11.0,10.9)
anio <- c(2010,2015,2016,2017)
oecd <- data.frame(anio,gasto)
g2=ggplot(oecd) +
geom_line(aes(x=anio, y=gasto, color = "red")) +
geom_point(aes(x=anio, y=gasto),size=3.0) +
scale_y_continuous(limits=c(0,100),breaks = seq(0,100,by=10)) +
scale_x_continuous(breaks = seq(2009,2017,by=2.0))+
xlab("Año")+
ylab("Porcentaje") +
theme_bw()+
theme(legend.position="none") +
ggtitle("Gasto social") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.position = "bottom",
axis.text=element_text(size=12),
axis.title.y = element_text(size=14, face="bold"),
plot.title=element_text(hjust=0.5,size = 10,face = "bold"))+
guides(colour=FALSE)
g2
g1=ggplot(data) +
geom_line(aes(x=anio, y=gini, color = "red")) +
geom_point(aes(x=anio, y=gini),size=3.0) +
scale_y_continuous(limits=c(0,100),breaks = seq(0,100,by=10)) +
scale_x_continuous(breaks = seq(2009,2017,by=2.0))+
xlab("Año")+
ylab("Percentaje") +
theme_bw()+
theme(legend.position="none") +
ggtitle("Coeficiente de Gini") + theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 10),
legend.position = "bottom",
axis.text=element_text(size=12),
axis.title.y = element_text(size=14, face="bold"),
plot.title=element_text(hjust=0.5,size = 10,face = "bold"))+
guides(colour=FALSE)
g1
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = -5.4,
gp=gpar(fontsize=10,font=1)))
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = -4.0,
gp=gpar(fontsize=10,font=1)))
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = 0,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = 0.5,
gp=gpar(fontsize=10,font=1)))
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = -0.5,
gp=gpar(fontsize=10,font=1)))
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = -0.3,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = -0.5,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = -1.0,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE",
just = "left",hjust = -0.9,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
redisGDP <- data.frame(stringsAsFactors=FALSE,
Pais = c("Australia", "Austria", "Belgica", "Canada", "Chile",
"Republica Checa", "Dinamarca", "Estonia",
"Finlandia", "Francia", "Alemania", "Grecia", "Hungria",
"Islandia", "Irlanda", "Israel", "Italia", "Japon",
"Corea del Sur", "Latvia", "Lituania", "Luxemburgo",
"Holanda", "Nueva Zelanda", "Noruega", "Polonia",
"Portugal", "Eslovaquia", "Eslovenia", "España",
"Suecia", "Suiza", "UK", "US", "Costa Rica", "Rusia"),
GiniPost = c(0.33, 0.284, 0.266, 0.307, 0.46, 0.253, 0.261, 0.314, 0.259,
0.291, 0.294, 0.333, 0.282, 0.255, 0.309, 0.346,
0.328, 0.339, 0.355, 0.346, 0.378, 0.304, 0.288,
0.349, 0.262, 0.284, 0.331, 0.241, 0.244, 0.341, 0.282,
0.296, 0.351, 0.391, 0.484, 0.331),
GiniPre = c(0.469, 0.501, 0.499, 0.431, 0.495, 0.448, 0.447, 0.456, 0.506,
0.516, 0.505, 0.536, 0.485, 0.386, 0.543, 0.44,
0.517, 0.504, 0.402, 0.475, 0.515, 0.482, 0.446,
0.462, 0.428, 0.459, 0.53, 0.4, 0.452, 0.516, 0.435,
0.386, 0.506, 0.507, 0.533, 0.466),
GDP = c(45929, 43247, 41284, 42485, 20855, 30542, 45458, 26655, 39172,
37169, 43102, 23703, 24861, 43726, 59694, 31832,
33646, 37036, 35035, 22839, 26721, 89528, 46612,
34498, 59551, 24928, 27302, 28981, 29064, 32687, 45341,
54453, 39142, 52583, 14807, 23094),
Year1 = c(2016, 2016, 2016, 2016, 2017, 2016, 2016, 2016, 2016, 2016,
2016, 2016, 2016, 2015, 2016, 2016, 2016, 2015,
2016, 2016, 2016, 2016, 2015, 2014, 2016, 2016, 2016,
2016, 2016, 2016, 2016, 2015, 2016, 2016, 2016,
2016),
group = c(0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
)
redisGDP$group <- as.factor(redisGDP$group)
redisGDP$Redistribucion <- 100*(1 - (redisGDP$GiniPost/redisGDP$GiniPre))
redisGDP$Redistribucion2 <- redisGDP$Redistribucion
redist01<- ggplot(redisGDP,aes(x=GDP,y=Redistribucion)) +
geom_point(aes(color=group,size=Redistribucion2), alpha=0.4) + scale_size(range = c(1, 10)) +
scale_color_manual(values=c("gray50","red")) +
geom_text(aes(y=Redistribucion+.8,label=Pais,color=group),size=4, vjust=0) +
scale_x_continuous(breaks = seq(10000,90000,by=10000),limits=c(12000,93000)) +
geom_smooth(method="lm", se=FALSE, color="gray50") +
labs(y="Reducción del Gini debido a impuestos y transferencias",x="PIB per capita",
caption = "Fuente: OCDE") +
theme_bw() +
theme(legend.position="none") +
guides(colour=FALSE)
redist01
redist01<- ggplot(redisGDP,aes(x=GDP,y=Redistribucion)) +
geom_point(aes(color=group,size=Redistribucion2), alpha=0.4) + scale_size(range = c(1, 10)) +
scale_color_manual(values=c("gray50","red")) +
geom_text(aes(y=Redistribucion+.8,label=Pais,color=group),size=4, vjust=0) +
scale_x_continuous(breaks = seq(10000,90000,by=10000),limits=c(12000,93000)) +
geom_smooth(method="lm", se=FALSE, color="gray50") +
labs(y="Reducción del Gini debido a impuestos y transferencias",x="PIB per capita",
caption = "Fuente: Elaboración propia a partir de datos OCDE") +
theme_bw() +
theme(legend.position="none") +
guides(colour=FALSE)
redist01
ggsave(redist01,filename = "images/Figura2.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE.",
just = "left",hjust = -0.9,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE.",
just = "left",hjust = -0.8,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE.",
just = "left",hjust = -0.85,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Graficos juntos
gasto<- grid.arrange(g1,g2,ncol=2,
bottom=textGrob(label = "Fuente: Elaboración propia a partir de datos OCDE.",
just = "left",hjust = -0.87,
gp=gpar(fontsize=10,font=1)))
ggsave(gasto,filename = "images/Figura1.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
redisGDP <- data.frame(stringsAsFactors=FALSE,
Pais = c("Australia", "Austria", "Belgica", "Canada", "Chile",
"Republica Checa", "Dinamarca", "Estonia",
"Finlandia", "Francia", "Alemania", "Grecia", "Hungria",
"Islandia", "Irlanda", "Israel", "Italia", "Japon",
"Corea del Sur", "Latvia", "Lituania", "Luxemburgo",
"Holanda", "Nueva Zelanda", "Noruega", "Polonia",
"Portugal", "Eslovaquia", "Eslovenia", "España",
"Suecia", "Suiza", "UK", "US", "Costa Rica", "Rusia"),
GiniPost = c(0.33, 0.284, 0.266, 0.307, 0.46, 0.253, 0.261, 0.314, 0.259,
0.291, 0.294, 0.333, 0.282, 0.255, 0.309, 0.346,
0.328, 0.339, 0.355, 0.346, 0.378, 0.304, 0.288,
0.349, 0.262, 0.284, 0.331, 0.241, 0.244, 0.341, 0.282,
0.296, 0.351, 0.391, 0.484, 0.331),
GiniPre = c(0.469, 0.501, 0.499, 0.431, 0.495, 0.448, 0.447, 0.456, 0.506,
0.516, 0.505, 0.536, 0.485, 0.386, 0.543, 0.44,
0.517, 0.504, 0.402, 0.475, 0.515, 0.482, 0.446,
0.462, 0.428, 0.459, 0.53, 0.4, 0.452, 0.516, 0.435,
0.386, 0.506, 0.507, 0.533, 0.466),
GDP = c(45929, 43247, 41284, 42485, 20855, 30542, 45458, 26655, 39172,
37169, 43102, 23703, 24861, 43726, 59694, 31832,
33646, 37036, 35035, 22839, 26721, 89528, 46612,
34498, 59551, 24928, 27302, 28981, 29064, 32687, 45341,
54453, 39142, 52583, 14807, 23094),
Year1 = c(2016, 2016, 2016, 2016, 2017, 2016, 2016, 2016, 2016, 2016,
2016, 2016, 2016, 2015, 2016, 2016, 2016, 2015,
2016, 2016, 2016, 2016, 2015, 2014, 2016, 2016, 2016,
2016, 2016, 2016, 2016, 2015, 2016, 2016, 2016,
2016),
group = c(0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
)
redisGDP$group <- as.factor(redisGDP$group)
redisGDP$Redistribucion <- 100*(1 - (redisGDP$GiniPost/redisGDP$GiniPre))
redisGDP$Redistribucion2 <- redisGDP$Redistribucion
redist01<- ggplot(redisGDP,aes(x=GDP,y=Redistribucion)) +
geom_point(aes(color=group,size=Redistribucion2), alpha=0.4) + scale_size(range = c(1, 10)) +
scale_color_manual(values=c("gray50","red")) +
geom_text(aes(y=Redistribucion+.8,label=Pais,color=group),size=4, vjust=0) +
scale_x_continuous(breaks = seq(10000,90000,by=10000),limits=c(12000,93000)) +
geom_smooth(method="lm", se=FALSE, color="gray50") +
labs(y="Reducción del Gini debido a impuestos y transferencias",x="PIB per capita",
caption = "Fuente: Elaboración propia a partir de datos OCDE.") +
theme_bw() +
theme(legend.position="none") +
guides(colour=FALSE)
redist01
ggsave(redist01,filename = "images/Figura2.png",device = "png",width = 30,height = 15,dpi = "retina",units = "cm")
# Para obtener doble output (html/pdf) correr directamente en consola/terminal:
rmarkdown::render('index.rmd', output_format = 'all')
